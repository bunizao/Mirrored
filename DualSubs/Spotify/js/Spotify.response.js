console.log("🍿 DualSubs: 🎵 Spotify Response");const e=function(){if("undefined"!=typeof $environment&&$environment["surge-version"])return"Surge";if("undefined"!=typeof $environment&&$environment["stash-version"])return"Stash";if("undefined"!=typeof module&&module.exports)return"Node.js";if("undefined"!=typeof $task)return"Quantumult X";if("undefined"!=typeof $loon)return"Loon";if("undefined"!=typeof $rocket)return"Shadowrocket";if("undefined"!=typeof Egern)return"Egern"}();class t{static name="Lodash";static version="1.2.2";static about(){return console.log(`\n🟧 ${this.name} v${this.version}\n`)}static get(e={},t="",n=void 0){Array.isArray(t)||(t=this.toPath(t));const r=t.reduce(((e,t)=>Object(e)[t]),e);return void 0===r?n:r}static set(e={},t="",n){return Array.isArray(t)||(t=this.toPath(t)),t.slice(0,-1).reduce(((e,n,r)=>Object(e[n])===e[n]?e[n]:e[n]=/^\d+$/.test(t[r+1])?[]:{}),e)[t[t.length-1]]=n,e}static unset(e={},t=""){return Array.isArray(t)||(t=this.toPath(t)),t.reduce(((e,n,r)=>r===t.length-1?(delete e[n],!0):Object(e)[n]),e)}static toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}static escape(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}static unescape(e){const t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,(e=>t[e]))}}class n{static name="Storage";static version="1.1.0";static about(){return r("",`🟧 ${this.name} v${this.version}`,"")}static data=null;static dataFile="box.dat";static#e=/^@(?<key>[^.]+)(?:\.(?<path>.*))?$/;static getItem(n=new String,r=null){let s=r;if(!0===n.startsWith("@")){const{key:e,path:r}=n.match(this.#e)?.groups;n=e;let a=this.getItem(n,{});"object"!=typeof a&&(a={}),s=t.get(a,r);try{s=JSON.parse(s)}catch(e){}}else{switch(e){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":s=$persistentStore.read(n);break;case"Quantumult X":s=$prefs.valueForKey(n);break;case"Node.js":this.data=this.#t(this.dataFile),s=this.data?.[n];break;default:s=this.data?.[n]||null}try{s=JSON.parse(s)}catch(e){}}return s??r}static setItem(n=new String,r=new String){let s=!1;if("object"==typeof r)r=JSON.stringify(r);else r=String(r);if(!0===n.startsWith("@")){const{key:e,path:a}=n.match(this.#e)?.groups;n=e;let i=this.getItem(n,{});"object"!=typeof i&&(i={}),t.set(i,a,r),s=this.setItem(n,i)}else switch(e){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":s=$persistentStore.write(r,n);break;case"Quantumult X":s=$prefs.setValueForKey(r,n);break;case"Node.js":this.data=this.#t(this.dataFile),this.data[n]=r,this.#n(this.dataFile),s=!0;break;default:s=this.data?.[n]||null}return s}static removeItem(n){let r=!1;if(!0===n.startsWith("@")){const{key:e,path:s}=n.match(this.#e)?.groups;n=e;let a=this.getItem(n);"object"!=typeof a&&(a={}),keyValue=t.unset(a,s),r=this.setItem(n,a)}else switch(e){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:r=!1;break;case"Quantumult X":r=$prefs.removeValueForKey(n)}return r}static clear(){let t=!1;switch(e){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:t=!1;break;case"Quantumult X":t=$prefs.removeAllValues()}return t}static#t(e){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),n=this.path.resolve(process.cwd(),e),r=this.fs.existsSync(t),s=!r&&this.fs.existsSync(n);if(!r&&!s)return{};{const e=r?t:n;try{return JSON.parse(this.fs.readFileSync(e))}catch(e){return{}}}}}static#n(e=this.dataFile){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),n=this.path.resolve(process.cwd(),e),r=this.fs.existsSync(t),s=!r&&this.fs.existsSync(n),a=JSON.stringify(this.data);r?this.fs.writeFileSync(t,a):s?this.fs.writeFileSync(n,a):this.fs.writeFileSync(t,a)}}}const r=(...e)=>console.log(e.join("\n"));var s={Switch:!0,Type:"Translate",Types:["Official","Translate"],Languages:["EN","ZH"],CacheSize:50},a={breakLine:{"text/xml":"&#x000A;","application/xml":"&#x000A;","text/vtt":"\n","application/vtt":"\n","text/json":"\n","application/json":"\n"}},i={Settings:s,Configs:a},o={Switch:!0,Types:["Translate","External"],Languages:["AUTO","ZH"]},l={Settings:o},c=Database={Default:Object.freeze({__proto__:null,Configs:a,Settings:s,default:i}),Spotify:Object.freeze({__proto__:null,Settings:o,default:l})};function u(e,s,a){r("☑️ Set Environment Variables","");let{Settings:i,Caches:o,Configs:l}=function(e,r,s){let a=n.getItem(e,s),i={};switch(typeof $argument){case"string":let e=Object.fromEntries($argument.split("&").map((e=>e.split("=").map((e=>e.replace(/\"/g,""))))));for(let n in e)t.set(i,n,e[n]);break;case"object":for(let e in $argument)t.set(i,e,$argument[e])}const o={Settings:s?.Default?.Settings||{},Configs:s?.Default?.Configs||{},Caches:{}};Array.isArray(r)||(r=[r]);for(let e of r)o.Settings={...o.Settings,...s?.[e]?.Settings,...i,...a?.[e]?.Settings},o.Configs={...o.Configs,...s?.[e]?.Configs},a?.[e]?.Caches&&"string"==typeof a?.[e]?.Caches&&(a[e].Caches=JSON.parse(a?.[e]?.Caches)),o.Caches={...o.Caches,...a?.[e]?.Caches};return function e(t,n){for(var r in t){var s=t[r];t[r]="object"==typeof s&&null!==s?e(s,n):n(r,s)}return t}(o.Settings,((e,t)=>("true"===t||"false"===t?t=JSON.parse(t):"string"==typeof t&&(t=t.includes(",")?t.split(",").map((e=>l(e))):l(t)),t))),o;function l(e){return e&&!isNaN(e)&&(e=parseInt(e,10)),e}}(e,s,a);return Array.isArray(i?.Types)||(i.Types=i.Types?[i.Types]:[]),r(`✅ Set Environment Variables, Settings: ${typeof i}, Settings内容: ${JSON.stringify(i)}`,""),("object"!=typeof o?.Playlists||Array.isArray(o?.Playlists))&&(o.Playlists={}),o.Playlists.Master=new Map(JSON.parse(o?.Playlists?.Master||"[]")),o.Playlists.Subtitle=new Map(JSON.parse(o?.Playlists?.Subtitle||"[]")),"object"!=typeof o?.Subtitles&&(o.Subtitles=new Map(JSON.parse(o?.Subtitles||"[]"))),("object"!=typeof o?.Metadatas||Array.isArray(o?.Metadatas))&&(o.Metadatas={}),"object"!=typeof o?.Metadatas?.Tracks&&(o.Metadatas.Tracks=new Map(JSON.parse(o?.Metadatas?.Tracks||"[]"))),{Settings:i,Caches:o,Configs:l}}function h(e={}){return e["audiobook-onboarding-completed"]={boolValue:!0},e["has-audiobooks-subscription"]={boolValue:!0},e["player-license"]={stringValue:"premium"},e.mobile={boolValue:!0},e["financial-product"]={stringValue:"pr:premium,tc:0"},e["premium-mini"]={boolValue:!0},e["streaming-rules"]={stringValue:""},e["license-acceptance-grace-days"]={longValue:"30"},e.name={stringValue:"Spotify Premium"},e["mobile-login"]={boolValue:!0},e["hifi-optin-intent"]={boolValue:!0},e["pick-and-shuffle"]={boolValue:!1},e["on-demand"]={boolValue:!0},e.ads={boolValue:!1},e.catalogue={stringValue:"premium"},e["high-bitrate"]={boolValue:!0},e.libspotify={boolValue:!0},e["nft-disabled"]={stringValue:"1"},e.shuffle={boolValue:!1},e["audio-quality"]={stringValue:"1"},e.offline={boolValue:!0},e["hifi-eligible"]={boolValue:!0},e["pause-after"]={longValue:"0"},e["addon-hifi"]={boolValue:!0},e.can_use_superbird={boolValue:!0},e.type={stringValue:"premium"},e["india-experience"]={stringValue:"1"},e["loudness-levels"]={stringValue:"1:-9.0,0.0,3.0:-2.0"},e["payments-initial-campaign"]={stringValue:"web"},e["shuffle-eligible"]={boolValue:!0},e.unrestricted={boolValue:!0},e["com.spotify.madprops.use.ucs.product.state"]={boolValue:!0},e}function f(e){let t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}function d(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}let p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),m=[];for(let e=0;e<p.length;e++)m[p[e].charCodeAt(0)]=e;var g,T;function y(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function S(e,t,n){for(let r=0;r<28;r+=7){const s=e>>>r,a=!(s>>>7==0&&0==t),i=255&(a?128|s:s);if(n.push(i),!a)return}const r=e>>>28&15|(7&t)<<4,s=!!(t>>3);if(n.push(255&(s?128|r:r)),s){for(let e=3;e<31;e+=7){const r=t>>>e,s=!(r>>>7==0),a=255&(s?128|r:r);if(n.push(a),!s)return}n.push(t>>>31&1)}}m["-".charCodeAt(0)]=p.indexOf("+"),m["_".charCodeAt(0)]=p.indexOf("/"),function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(n,r,s,a,i)=>{(t(r)?r[e.symbol]:r[e.symbol]=[]).push({no:s,wireType:a,data:i})},e.onWrite=(t,n,r)=>{for(let{no:t,wireType:s,data:a}of e.list(n))r.tag(t,s).raw(a)},e.list=(n,r)=>{if(t(n)){let t=n[e.symbol];return r?t.filter((e=>e.no==r)):t}return[]},e.last=(t,n)=>e.list(t,n).slice(-1)[0];const t=t=>t&&Array.isArray(t[e.symbol])}(g||(g={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(T||(T={}));const b=4294967296;function I(e){let t="-"==e[0];t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function a(t,a){const i=Number(e.slice(t,a));s*=n,r=r*n+i,r>=b&&(s+=r/b|0,r%=b)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),[t,r,s]}function E(e,t){if(t>>>0<=2097151)return""+(b*t+(e>>>0));let n=(e>>>24|t<<8)>>>0&16777215,r=t>>16&65535,s=(16777215&e)+6777216*n+6710656*r,a=n+8147497*r,i=2*r,o=1e7;function l(e,t){let n=e?String(e):"";return t?"0000000".slice(n.length)+n:n}return s>=o&&(a+=Math.floor(s/o),s%=o),a>=o&&(i+=Math.floor(a/o),a%=o),l(i,0)+l(a,i)+l(s,1)}function w(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function N(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}let O;function k(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}!function(){const e=new DataView(new ArrayBuffer(8)),t=void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64;O=t?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();const A=/^-?[0-9]+$/,R=4294967296,_=2147483648;class D{constructor(e,t){this.lo=0|e,this.hi=0|t}isZero(){return 0==this.lo&&0==this.hi}toNumber(){let e=this.hi*R+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class C extends D{static from(e){if(O)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=O.C(e);case"number":if(0===e)return this.ZERO;e=O.C(e);case"bigint":if(!e)return this.ZERO;if(e<O.UMIN)throw new Error("signed value for ulong");if(e>O.UMAX)throw new Error("ulong too large");return O.V.setBigUint64(0,e,!0),new C(O.V.getInt32(0,!0),O.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!A.test(e))throw new Error("string is no integer");let[t,n,r]=I(e);if(t)throw new Error("signed value for ulong");return new C(n,r);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new C(e,e/R)}throw new Error("unknown value "+typeof e)}toString(){return O?this.toBigInt().toString():E(this.lo,this.hi)}toBigInt(){return k(O),O.V.setInt32(0,this.lo,!0),O.V.setInt32(4,this.hi,!0),O.V.getBigUint64(0,!0)}}C.ZERO=new C(0,0);class U extends D{static from(e){if(O)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=O.C(e);case"number":if(0===e)return this.ZERO;e=O.C(e);case"bigint":if(!e)return this.ZERO;if(e<O.MIN)throw new Error("signed long too small");if(e>O.MAX)throw new Error("signed long too large");return O.V.setBigInt64(0,e,!0),new U(O.V.getInt32(0,!0),O.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!A.test(e))throw new Error("string is no integer");let[t,n,r]=I(e);if(t){if(r>_||r==_&&0!=n)throw new Error("signed long too small")}else if(r>=_)throw new Error("signed long too large");let s=new U(n,r);return t?s.negate():s;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new U(e,e/R):new U(-e,-e/R).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return!!(this.hi&_)}negate(){let e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new U(t,e)}toString(){if(O)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+E(e.lo,e.hi)}return E(this.lo,this.hi)}toBigInt(){return k(O),O.V.setInt32(0,this.lo,!0),O.V.setInt32(4,this.hi,!0),O.V.getBigInt64(0,!0)}}U.ZERO=new U(0,0);const L={readUnknownField:!0,readerFactory:e=>new B(e)};class B{constructor(e,t){this.varint64=y,this.uint32=N,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case T.Varint:for(;128&this.buf[this.pos++];);break;case T.Bit64:this.pos+=4;case T.Bit32:this.pos+=4;break;case T.LengthDelimited:let t=this.uint32();this.pos+=t;break;case T.StartGroup:let n;for(;(n=this.tag()[1])!==T.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return new U(...this.varint64())}uint64(){return new C(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,new U(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new C(this.sfixed32(),this.sfixed32())}sfixed64(){return new U(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function v(e,t){if(!e)throw new Error(t)}function P(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function V(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function x(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const F={writeUnknownFields:!0,writerFactory:()=>new $};class ${constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(V(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return P(e),w(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){x(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){V(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){P(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return P(e),w(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=U.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=C.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=U.from(e);return S(t.lo,t.hi,this.buf),this}sint64(e){let t=U.from(e),n=t.hi>>31;return S(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=C.from(e);return S(t.lo,t.hi,this.buf),this}}const j={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},M={ignoreUnknownFields:!1};function W(e){return e?Object.assign(Object.assign({},j),e):j}const K=Symbol.for("protobuf-ts/message-type");function G(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let s=e.charAt(r);"_"==s?t=!0:/\d/.test(s)?(n.push(s),t=!0):t?(n.push(s.toUpperCase()),t=!1):0==r?n.push(s.toLowerCase()):n.push(s)}return n.join("")}var H,X,Y;function J(e){var t,n,r,s;return e.localName=null!==(t=e.localName)&&void 0!==t?t:G(e.name),e.jsonName=null!==(n=e.jsonName)&&void 0!==n?n:G(e.name),e.repeat=null!==(r=e.repeat)&&void 0!==r?r:Y.NO,e.opt=null!==(s=e.opt)&&void 0!==s?s:!e.repeat&&(!e.oneof&&"message"==e.kind),e}function q(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(H||(H={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(X||(X={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(Y||(Y={}));class Z{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}prepare(){if(this.data)return;const e=[],t=[],n=[];for(let r of this.fields)if(r.oneof)n.includes(r.oneof)||(n.push(r.oneof),e.push(r.oneof),t.push(r.oneof));else switch(t.push(r.localName),r.kind){case"scalar":case"enum":r.opt&&!r.repeat||e.push(r.localName);break;case"message":r.repeat&&e.push(r.localName);break;case"map":e.push(r.localName)}this.data={req:e,known:t,oneofs:Object.values(n)}}is(e,t,n=!1){if(t<0)return!0;if(null==e||"object"!=typeof e)return!1;this.prepare();let r=Object.keys(e),s=this.data;if(r.length<s.req.length||s.req.some((e=>!r.includes(e))))return!1;if(!n&&r.some((e=>!s.known.includes(e))))return!1;if(t<1)return!0;for(const r of s.oneofs){const s=e[r];if(!q(s))return!1;if(void 0===s.oneofKind)continue;const a=this.fields.find((e=>e.localName===s.oneofKind));if(!a)return!1;if(!this.field(s[s.oneofKind],a,n,t))return!1}for(const r of this.fields)if(void 0===r.oneof&&!this.field(e[r.localName],r,n,t))return!1;return!0}field(e,t,n,r){let s=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:s?this.scalars(e,t.T,r,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:s?this.scalars(e,H.INT32,r):this.scalar(e,H.INT32);case"message":return void 0===e||(s?this.messages(e,t.T(),n,r):this.message(e,t.T(),n,r));case"map":if("object"!=typeof e||null===e)return!1;if(r<2)return!0;if(!this.mapKeys(e,t.K,r))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,r,t.V.L);case"enum":return this.scalars(Object.values(e),H.INT32,r);case"message":return this.messages(Object.values(e),t.V.T(),n,r)}}return!0}message(e,t,n,r){return n?t.isAssignable(e,r):t.is(e,r)}messages(e,t,n,r){if(!Array.isArray(e))return!1;if(r<2)return!0;if(n){for(let n=0;n<e.length&&n<r;n++)if(!t.isAssignable(e[n],r-1))return!1}else for(let n=0;n<e.length&&n<r;n++)if(!t.is(e[n],r-1))return!1;return!0}scalar(e,t,n){let r=typeof e;switch(t){case H.UINT64:case H.FIXED64:case H.INT64:case H.SFIXED64:case H.SINT64:switch(n){case X.BIGINT:return"bigint"==r;case X.NUMBER:return"number"==r&&!isNaN(e);default:return"string"==r}case H.BOOL:return"boolean"==r;case H.STRING:return"string"==r;case H.BYTES:return e instanceof Uint8Array;case H.DOUBLE:case H.FLOAT:return"number"==r&&!isNaN(e);default:return"number"==r&&Number.isInteger(e)}}scalars(e,t,n,r){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e))for(let s=0;s<e.length&&s<n;s++)if(!this.scalar(e[s],t,r))return!1;return!0}mapKeys(e,t,n){let r=Object.keys(e);switch(t){case H.INT32:case H.FIXED32:case H.SFIXED32:case H.SINT32:case H.UINT32:return this.scalars(r.slice(0,n).map((e=>parseInt(e))),t,n);case H.BOOL:return this.scalars(r.slice(0,n).map((e=>"true"==e||"false"!=e&&e)),t,n);default:return this.scalars(r,t,n,X.STRING)}}}function Q(e,t){switch(t){case X.BIGINT:return e.toBigInt();case X.NUMBER:return e.toNumber();default:return e.toString()}}class z{constructor(e){this.info=e}prepare(){var e;if(void 0===this.fMap){this.fMap={};const t=null!==(e=this.info.fields)&&void 0!==e?e:[];for(const e of t)this.fMap[e.name]=e,this.fMap[e.jsonName]=e,this.fMap[e.localName]=e}}assert(e,t,n){if(!e){let e=f(n);throw"number"!=e&&"boolean"!=e||(e=n.toString()),new Error(`Cannot parse JSON ${e} for ${this.info.typeName}#${t}`)}}read(e,t,n){this.prepare();const r=[];for(const[s,a]of Object.entries(e)){const e=this.fMap[s];if(!e){if(!n.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${s}`);continue}const i=e.localName;let o;if(e.oneof){if(null===a&&("enum"!==e.kind||"google.protobuf.NullValue"!==e.T()[0]))continue;if(r.includes(e.oneof))throw new Error(`Multiple members of the oneof group "${e.oneof}" of ${this.info.typeName} are present in JSON.`);r.push(e.oneof),o=t[e.oneof]={oneofKind:i}}else o=t;if("map"==e.kind){if(null===a)continue;this.assert(d(a),e.name,a);const t=o[i];for(const[r,s]of Object.entries(a)){let a;switch(this.assert(null!==s,e.name+" map value",null),e.V.kind){case"message":a=e.V.T().internalJsonRead(s,n);break;case"enum":if(a=this.enum(e.V.T(),s,e.name,n.ignoreUnknownFields),!1===a)continue;break;case"scalar":a=this.scalar(s,e.V.T,e.V.L,e.name)}this.assert(void 0!==a,e.name+" map value",s);let i=r;e.K==H.BOOL&&(i="true"==i||"false"!=i&&i),i=this.scalar(i,e.K,X.STRING,e.name).toString(),t[i]=a}}else if(e.repeat){if(null===a)continue;this.assert(Array.isArray(a),e.name,a);const t=o[i];for(const r of a){let s;switch(this.assert(null!==r,e.name,null),e.kind){case"message":s=e.T().internalJsonRead(r,n);break;case"enum":if(s=this.enum(e.T(),r,e.name,n.ignoreUnknownFields),!1===s)continue;break;case"scalar":s=this.scalar(r,e.T,e.L,e.name)}this.assert(void 0!==s,e.name,a),t.push(s)}}else switch(e.kind){case"message":if(null===a&&"google.protobuf.Value"!=e.T().typeName){this.assert(void 0===e.oneof,e.name+" (oneof member)",null);continue}o[i]=e.T().internalJsonRead(a,n,o[i]);break;case"enum":let t=this.enum(e.T(),a,e.name,n.ignoreUnknownFields);if(!1===t)continue;o[i]=t;break;case"scalar":o[i]=this.scalar(a,e.T,e.L,e.name)}}}enum(e,t,n,r){if("google.protobuf.NullValue"==e[0]&&v(null===t||"NULL_VALUE"===t,`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} only accepts null.`),null===t)return 0;switch(typeof t){case"number":return v(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${n}, enum can only be integral number, got ${t}.`),t;case"string":let s=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(s=t.substring(e[2].length));let a=e[1][s];return(void 0!==a||!r)&&(v("number"==typeof a,`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} has no value for "${t}".`),a)}v(!1,`Unable to parse field ${this.info.typeName}#${n}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,n,r){let s;try{switch(t){case H.DOUBLE:case H.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){s="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){s="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;let r=Number(e);if(Number.isNaN(r)){s="not a number";break}if(!Number.isFinite(r)){s="too large or small";break}return t==H.FLOAT&&x(r),r;case H.INT32:case H.FIXED32:case H.SFIXED32:case H.SINT32:case H.UINT32:if(null===e)return 0;let a;if("number"==typeof e?a=e:""===e?s="empty string":"string"==typeof e&&(e.trim().length!==e.length?s="extra whitespace":a=Number(e)),void 0===a)break;return t==H.UINT32?V(a):P(a),a;case H.INT64:case H.SFIXED64:case H.SINT64:if(null===e)return Q(U.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return Q(U.from(e),n);case H.FIXED64:case H.UINT64:if(null===e)return Q(C.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return Q(C.from(e),n);case H.BOOL:if(null===e)return!1;if("boolean"!=typeof e)break;return e;case H.STRING:if(null===e)return"";if("string"!=typeof e){s="extra whitespace";break}try{encodeURIComponent(e)}catch(s){s="invalid UTF8";break}return e;case H.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!=typeof e)break;return function(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,r=new Uint8Array(t),s=0,a=0,i=0;for(let t=0;t<e.length;t++){if(n=m[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":a=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:i=n,a=1;break;case 1:r[s++]=i<<2|(48&n)>>4,i=n,a=2;break;case 2:r[s++]=(15&i)<<4|(60&n)>>2,i=n,a=3;break;case 3:r[s++]=(3&i)<<6|n,a=0}}if(1==a)throw Error("invalid base64 string.");return r.subarray(0,s)}(e)}}catch(e){s=e.message}this.assert(!1,r+(s?" - "+s:""),e)}}class ee{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}write(e,t){const n={},r=e;for(const e of this.fields){if(!e.oneof){let s=this.field(e,r[e.localName],t);void 0!==s&&(n[t.useProtoFieldName?e.name:e.jsonName]=s);continue}const s=r[e.oneof];if(s.oneofKind!==e.localName)continue;const a="scalar"==e.kind||"enum"==e.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let i=this.field(e,s[e.localName],a);v(void 0!==i),n[t.useProtoFieldName?e.name:e.jsonName]=i}return n}field(e,t,n){let r;if("map"==e.kind){v("object"==typeof t&&null!==t);const s={};switch(e.V.kind){case"scalar":for(const[n,r]of Object.entries(t)){const t=this.scalar(e.V.T,r,e.name,!1,!0);v(void 0!==t),s[n.toString()]=t}break;case"message":const r=e.V.T();for(const[a,i]of Object.entries(t)){const t=this.message(r,i,e.name,n);v(void 0!==t),s[a.toString()]=t}break;case"enum":const a=e.V.T();for(const[r,i]of Object.entries(t)){v(void 0===i||"number"==typeof i);const t=this.enum(a,i,e.name,!1,!0,n.enumAsInteger);v(void 0!==t),s[r.toString()]=t}}(n.emitDefaultValues||Object.keys(s).length>0)&&(r=s)}else if(e.repeat){v(Array.isArray(t));const s=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++){const r=this.scalar(e.T,t[n],e.name,e.opt,!0);v(void 0!==r),s.push(r)}break;case"enum":const r=e.T();for(let a=0;a<t.length;a++){v(void 0===t[a]||"number"==typeof t[a]);const i=this.enum(r,t[a],e.name,e.opt,!0,n.enumAsInteger);v(void 0!==i),s.push(i)}break;case"message":const a=e.T();for(let r=0;r<t.length;r++){const i=this.message(a,t[r],e.name,n);v(void 0!==i),s.push(i)}}(n.emitDefaultValues||s.length>0||n.emitDefaultValues)&&(r=s)}else switch(e.kind){case"scalar":r=this.scalar(e.T,t,e.name,e.opt,n.emitDefaultValues);break;case"enum":r=this.enum(e.T(),t,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":r=this.message(e.T(),t,e.name,n)}return r}enum(e,t,n,r,s,a){if("google.protobuf.NullValue"==e[0])return s||r?null:void 0;if(void 0!==t){if(0!==t||s||r)return v("number"==typeof t),v(Number.isInteger(t)),a||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else v(r)}message(e,t,n,r){return void 0===t?r.emitDefaultValues?null:void 0:e.internalJsonWrite(t,r)}scalar(e,t,n,r,s){if(void 0===t)return void v(r);const a=s||r;switch(e){case H.INT32:case H.SFIXED32:case H.SINT32:return 0===t?a?0:void 0:(P(t),t);case H.FIXED32:case H.UINT32:return 0===t?a?0:void 0:(V(t),t);case H.FLOAT:x(t);case H.DOUBLE:return 0===t?a?0:void 0:(v("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case H.STRING:return""===t?a?"":void 0:(v("string"==typeof t),t);case H.BOOL:return!1===t?!a&&void 0:(v("boolean"==typeof t),t);case H.UINT64:case H.FIXED64:v("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let e=C.from(t);if(e.isZero()&&!a)return;return e.toString();case H.INT64:case H.SFIXED64:case H.SINT64:v("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let n=U.from(t);if(n.isZero()&&!a)return;return n.toString();case H.BYTES:return v(t instanceof Uint8Array),t.byteLength?function(e){let t,n="",r=0,s=0;for(let a=0;a<e.length;a++)switch(t=e[a],r){case 0:n+=p[t>>2],s=(3&t)<<4,r=1;break;case 1:n+=p[s|t>>4],s=(15&t)<<2,r=2;break;case 2:n+=p[s|t>>6],n+=p[63&t],r=0}return r&&(n+=p[s],n+="=",1==r&&(n+="=")),n}(t):a?"":void 0}}}function te(e,t=X.STRING){switch(e){case H.BOOL:return!1;case H.UINT64:case H.FIXED64:return Q(C.ZERO,t);case H.INT64:case H.SFIXED64:case H.SINT64:return Q(U.ZERO,t);case H.DOUBLE:case H.FLOAT:return 0;case H.BYTES:return new Uint8Array(0);case H.STRING:return"";default:return 0}}class ne{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((e=>[e.no,e])))}}read(e,t,n,r){this.prepare();const s=void 0===r?e.len:e.pos+r;for(;e.pos<s;){const[r,s]=e.tag(),a=this.fieldNoToField.get(r);if(!a){let a=n.readUnknownField;if("throw"==a)throw new Error(`Unknown field ${r} (wire type ${s}) for ${this.info.typeName}`);let i=e.skip(s);!1!==a&&(!0===a?g.onRead:a)(this.info.typeName,t,r,s,i);continue}let i=t,o=a.repeat,l=a.localName;switch(a.oneof&&(i=i[a.oneof],i.oneofKind!==l&&(i=t[a.oneof]={oneofKind:l})),a.kind){case"scalar":case"enum":let t="enum"==a.kind?H.INT32:a.T,r="scalar"==a.kind?a.L:void 0;if(o){let n=i[l];if(s==T.LengthDelimited&&t!=H.STRING&&t!=H.BYTES){let s=e.uint32()+e.pos;for(;e.pos<s;)n.push(this.scalar(e,t,r))}else n.push(this.scalar(e,t,r))}else i[l]=this.scalar(e,t,r);break;case"message":if(o){let t=i[l],r=a.T().internalBinaryRead(e,e.uint32(),n);t.push(r)}else i[l]=a.T().internalBinaryRead(e,e.uint32(),n,i[l]);break;case"map":let[c,u]=this.mapEntry(a,e,n);i[l][c]=u}}}mapEntry(e,t,n){let r,s,a=t.uint32(),i=t.pos+a;for(;t.pos<i;){let[a,i]=t.tag();switch(a){case 1:r=e.K==H.BOOL?t.bool().toString():this.scalar(t,e.K,X.STRING);break;case 2:switch(e.V.kind){case"scalar":s=this.scalar(t,e.V.T,e.V.L);break;case"enum":s=t.int32();break;case"message":s=e.V.T().internalBinaryRead(t,t.uint32(),n)}break;default:throw new Error(`Unknown field ${a} (wire type ${i}) in map entry for ${this.info.typeName}#${e.name}`)}}if(void 0===r){let t=te(e.K);r=e.K==H.BOOL?t.toString():t}if(void 0===s)switch(e.V.kind){case"scalar":s=te(e.V.T,e.V.L);break;case"enum":s=0;break;case"message":s=e.V.T().create()}return[r,s]}scalar(e,t,n){switch(t){case H.INT32:return e.int32();case H.STRING:return e.string();case H.BOOL:return e.bool();case H.DOUBLE:return e.double();case H.FLOAT:return e.float();case H.INT64:return Q(e.int64(),n);case H.UINT64:return Q(e.uint64(),n);case H.FIXED64:return Q(e.fixed64(),n);case H.FIXED32:return e.fixed32();case H.BYTES:return e.bytes();case H.UINT32:return e.uint32();case H.SFIXED32:return e.sfixed32();case H.SFIXED64:return Q(e.sfixed64(),n);case H.SINT32:return e.sint32();case H.SINT64:return Q(e.sint64(),n)}}}class re{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort(((e,t)=>e.no-t.no))}}write(e,t,n){this.prepare();for(const r of this.fields){let s,a,i=r.repeat,o=r.localName;if(r.oneof){const t=e[r.oneof];if(t.oneofKind!==o)continue;s=t[o],a=!0}else s=e[o],a=!1;switch(r.kind){case"scalar":case"enum":let e="enum"==r.kind?H.INT32:r.T;if(i)if(v(Array.isArray(s)),i==Y.PACKED)this.packed(t,e,r.no,s);else for(const n of s)this.scalar(t,e,r.no,n,!0);else void 0===s?v(r.opt):this.scalar(t,e,r.no,s,a||r.opt);break;case"message":if(i){v(Array.isArray(s));for(const e of s)this.message(t,n,r.T(),r.no,e)}else this.message(t,n,r.T(),r.no,s);break;case"map":v("object"==typeof s&&null!==s);for(const[e,a]of Object.entries(s))this.mapEntry(t,n,r,e,a)}}let r=n.writeUnknownFields;!1!==r&&(!0===r?g.onWrite:r)(this.info.typeName,e,t)}mapEntry(e,t,n,r,s){e.tag(n.no,T.LengthDelimited),e.fork();let a=r;switch(n.K){case H.INT32:case H.FIXED32:case H.UINT32:case H.SFIXED32:case H.SINT32:a=Number.parseInt(r);break;case H.BOOL:v("true"==r||"false"==r),a="true"==r}switch(this.scalar(e,n.K,1,a,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,s,!0);break;case"enum":this.scalar(e,H.INT32,2,s,!0);break;case"message":this.message(e,t,n.V.T(),2,s)}e.join()}message(e,t,n,r,s){void 0!==s&&(n.internalBinaryWrite(s,e.tag(r,T.LengthDelimited).fork(),t),e.join())}scalar(e,t,n,r,s){let[a,i,o]=this.scalarInfo(t,r);o&&!s||(e.tag(n,a),e[i](r))}packed(e,t,n,r){if(!r.length)return;v(t!==H.BYTES&&t!==H.STRING),e.tag(n,T.LengthDelimited),e.fork();let[,s]=this.scalarInfo(t);for(let t=0;t<r.length;t++)e[s](r[t]);e.join()}scalarInfo(e,t){let n,r=T.Varint,s=void 0===t,a=0===t;switch(e){case H.INT32:n="int32";break;case H.STRING:a=s||!t.length,r=T.LengthDelimited,n="string";break;case H.BOOL:a=!1===t,n="bool";break;case H.UINT32:n="uint32";break;case H.DOUBLE:r=T.Bit64,n="double";break;case H.FLOAT:r=T.Bit32,n="float";break;case H.INT64:a=s||U.from(t).isZero(),n="int64";break;case H.UINT64:a=s||C.from(t).isZero(),n="uint64";break;case H.FIXED64:a=s||C.from(t).isZero(),r=T.Bit64,n="fixed64";break;case H.BYTES:a=s||!t.byteLength,r=T.LengthDelimited,n="bytes";break;case H.FIXED32:r=T.Bit32,n="fixed32";break;case H.SFIXED32:r=T.Bit32,n="sfixed32";break;case H.SFIXED64:a=s||U.from(t).isZero(),r=T.Bit64,n="sfixed64";break;case H.SINT32:n="sint32";break;case H.SINT64:a=s||U.from(t).isZero(),n="sint64"}return[r,n,s||a]}}function se(e,t,n){let r,s,a=n;for(let n of e.fields){let e=n.localName;if(n.oneof){const i=a[n.oneof];if(null==(null==i?void 0:i.oneofKind))continue;if(r=i[e],s=t[n.oneof],s.oneofKind=i.oneofKind,null==r){delete s[e];continue}}else if(r=a[e],s=t,null==r)continue;switch(n.repeat&&(s[e].length=r.length),n.kind){case"scalar":case"enum":if(n.repeat)for(let t=0;t<r.length;t++)s[e][t]=r[t];else s[e]=r;break;case"message":let t=n.T();if(n.repeat)for(let n=0;n<r.length;n++)s[e][n]=t.create(r[n]);else void 0===s[e]?s[e]=t.create(r):t.mergePartial(s[e],r);break;case"map":switch(n.V.kind){case"scalar":case"enum":Object.assign(s[e],r);break;case"message":let t=n.V.T();for(let n of Object.keys(r))s[e][n]=t.create(r[n])}}}}const ae=Object.values;function ie(e,t,n){if(t===n)return!0;if(e!==H.BYTES)return!1;let r=t,s=n;if(r.length!==s.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=s[e])return!1;return!0}function oe(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!ie(e,t[r],n[r]))return!1;return!0}function le(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e.equals(t[r],n[r]))return!1;return!0}const ce=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({}));class ue{constructor(e,t,n){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(J),this.options=null!=n?n:{},this.messagePrototype=Object.create(null,Object.assign(Object.assign({},ce),{[K]:{value:this}})),this.refTypeCheck=new Z(this),this.refJsonReader=new z(this),this.refJsonWriter=new ee(this),this.refBinReader=new ne(this),this.refBinWriter=new re(this)}create(e){let t=function(e){const t=e.messagePrototype?Object.create(e.messagePrototype):Object.defineProperty({},K,{value:e});for(let n of e.fields){let e=n.localName;if(!n.opt)if(n.oneof)t[n.oneof]={oneofKind:void 0};else if(n.repeat)t[e]=[];else switch(n.kind){case"scalar":t[e]=te(n.T,n.L);break;case"enum":t[e]=0;break;case"map":t[e]={}}}return t}(this);return void 0!==e&&se(this,t,e),t}clone(e){let t=this.create();return se(this,t,e),t}equals(e,t){return function(e,t,n){if(t===n)return!0;if(!t||!n)return!1;for(let r of e.fields){let e=r.localName,s=r.oneof?t[r.oneof][e]:t[e],a=r.oneof?n[r.oneof][e]:n[e];switch(r.kind){case"enum":case"scalar":let e="enum"==r.kind?H.INT32:r.T;if(!(r.repeat?oe(e,s,a):ie(e,s,a)))return!1;break;case"map":if(!("message"==r.V.kind?le(r.V.T(),ae(s),ae(a)):oe("enum"==r.V.kind?H.INT32:r.V.T,ae(s),ae(a))))return!1;break;case"message":let t=r.T();if(!(r.repeat?le(t,s,a):t.equals(s,a)))return!1}}return!0}(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){se(this,e,t)}fromBinary(e,t){let n=function(e){return e?Object.assign(Object.assign({},L),e):L}(t);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}fromJson(e,t){return this.internalJsonRead(e,function(e){return e?Object.assign(Object.assign({},M),e):M}(t))}fromJsonString(e,t){let n=JSON.parse(e);return this.fromJson(n,t)}toJson(e,t){return this.internalJsonWrite(e,W(t))}toJsonString(e,t){var n;let r=this.toJson(e,t);return JSON.stringify(r,null,null!==(n=null==t?void 0:t.prettySpaces)&&void 0!==n?n:0)}toBinary(e,t){let n=function(e){return e?Object.assign(Object.assign({},F),e):F}(t);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}internalJsonRead(e,t,n){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){let r=null!=n?n:this.create();return this.refJsonReader.read(e,r,t),r}throw new Error(`Unable to parse message ${this.typeName} from JSON ${f(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,n){return this.refBinWriter.write(e,t,n),t}internalBinaryRead(e,t,n,r){let s=null!=r?r:this.create();return this.refBinReader.read(e,s,n,t),s}}const he=new class extends ue{constructor(){super("BootstrapResponse",[{no:2,name:"ucsResponseV0",kind:"message",T:()=>fe},{no:3,name:"trialsFacadeResponseV1",kind:"message",T:()=>me}])}};const fe=new class extends ue{constructor(){super("UcsResponseWrapperV0",[{no:1,name:"success",kind:"message",T:()=>de},{no:2,name:"error",kind:"message",T:()=>Re}])}};const de=new class extends ue{constructor(){super("UcsResponseWrapperSuccess",[{no:1,name:"customization",kind:"message",T:()=>pe}])}};const pe=new class extends ue{constructor(){super("UcsResponseWrapper",[{no:1,name:"success",kind:"message",T:()=>Te},{no:2,name:"error",kind:"message",T:()=>Re}])}};const me=new class extends ue{constructor(){super("TrialsFacadeResponseWrapperV1",[{no:1,name:"success",kind:"message",T:()=>ge},{no:2,name:"error",kind:"message",T:()=>Re}])}};const ge=new class extends ue{constructor(){super("TrialsFacadeResponseWrapperSuccess",[{no:1,name:"filed1",kind:"scalar",T:5}])}};const Te=new class extends ue{constructor(){super("UcsResponse",[{no:1,name:"resolveSuccess",kind:"message",T:()=>ye},{no:2,name:"resolveError",kind:"message",T:()=>Re},{no:3,name:"accountAttributesSuccess",kind:"message",T:()=>ke},{no:4,name:"accountAttributesError",kind:"message",T:()=>Re},{no:5,name:"fetchTimeMillis",kind:"scalar",T:3,L:2}])}};const ye=new class extends ue{constructor(){super("ResolveResponse",[{no:1,name:"configuration",kind:"message",T:()=>Se}])}};const Se=new class extends ue{constructor(){super("Configuration",[{no:1,name:"configurationAssignmentId",kind:"scalar",T:9},{no:2,name:"fetchTimeMillis",kind:"scalar",T:3,L:2},{no:3,name:"assignedValues",kind:"message",repeat:1,T:()=>be}])}};const be=new class extends ue{constructor(){super("AssignedValue",[{no:1,name:"propertyId",kind:"message",T:()=>Ie},{no:2,name:"metadata",kind:"message",T:()=>Ee},{no:3,name:"boolValue",kind:"message",T:()=>we},{no:4,name:"intValue",kind:"message",T:()=>Oe},{no:5,name:"enumValue",kind:"message",T:()=>Ne}])}};const Ie=new class extends ue{constructor(){super("PropertyId",[{no:1,name:"scope",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}])}};const Ee=new class extends ue{constructor(){super("Metadata",[{no:1,name:"policyId",kind:"scalar",T:3,L:2},{no:2,name:"externalRealm",kind:"scalar",T:9},{no:3,name:"externalRealmId",kind:"scalar",T:3,L:2}])}};const we=new class extends ue{constructor(){super("BoolValue",[{no:1,name:"value",kind:"scalar",T:8}])}};const Ne=new class extends ue{constructor(){super("EnumValue",[{no:1,name:"value",kind:"scalar",T:9}])}};const Oe=new class extends ue{constructor(){super("IntValue",[{no:1,name:"value",kind:"scalar",T:5}])}};const ke=new class extends ue{constructor(){super("AccountAttributesResponse",[{no:1,name:"accountAttributes",kind:"map",K:9,V:{kind:"message",T:()=>Ae}}])}};const Ae=new class extends ue{constructor(){super("AccountAttribute",[{no:2,name:"boolValue",kind:"scalar",opt:!0,T:8},{no:3,name:"longValue",kind:"scalar",opt:!0,T:3,L:2},{no:4,name:"stringValue",kind:"scalar",opt:!0,T:9}])}};const Re=new class extends ue{constructor(){super("Error",[{no:1,name:"errorCode",kind:"scalar",T:5},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"logId",kind:"scalar",opt:!0,T:9}])}};const _e=new class extends ue{constructor(){super("google.protobuf.Any",[{no:1,name:"type_url",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:12}])}pack(e,t){return{typeUrl:this.typeNameToUrl(t.typeName),value:t.toBinary(e)}}unpack(e,t,n){if(!this.contains(e,t))throw new Error("Cannot unpack google.protobuf.Any with typeUrl '"+e.typeUrl+"' as "+t.typeName+".");return t.fromBinary(e.value,n)}contains(e,t){if(!e.typeUrl.length)return!1;return("string"==typeof t?t:t.typeName)===this.typeUrlToName(e.typeUrl)}internalJsonWrite(e,t){if(""===e.typeUrl)return{};let n=this.typeUrlToName(e.typeUrl),r=W(t),s=r.typeRegistry?.find((e=>e.typeName===n));if(!s)throw new globalThis.Error("Unable to convert google.protobuf.Any with typeUrl '"+e.typeUrl+"' to JSON. The specified type "+n+" is not available in the type registry.");let a=s.fromBinary(e.value,{readUnknownField:!1}),i=s.internalJsonWrite(a,r);return!n.startsWith("google.protobuf.")&&d(i)||(i={value:i}),i["@type"]=e.typeUrl,i}internalJsonRead(e,t,n){if(!d(e))throw new globalThis.Error("Unable to parse google.protobuf.Any from JSON "+f(e)+".");if("string"!=typeof e["@type"]||""==e["@type"])return this.create();let r,s=this.typeUrlToName(e["@type"]),a=t?.typeRegistry?.find((e=>e.typeName==s));if(!a)throw new globalThis.Error("Unable to parse google.protobuf.Any from JSON. The specified type "+s+" is not available in the type registry.");if(s.startsWith("google.protobuf.")&&e.hasOwnProperty("value"))r=a.fromJson(e.value,t);else{let n=Object.assign({},e);delete n["@type"],r=a.fromJson(n,t)}return void 0===n&&(n=this.create()),n.typeUrl=e["@type"],n.value=a.toBinary(r),n}typeNameToUrl(e){if(!e.length)throw new Error("invalid type name: "+e);return"type.googleapis.com/"+e}typeUrlToName(e){if(!e.length)throw new Error("invalid type url: "+e);let t=e.lastIndexOf("/"),n=t>0?e.substring(t+1):e;if(!n.length)throw new Error("invalid type url: "+e);return n}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.typeUrl="",t.value=new Uint8Array(0),void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.typeUrl=e.string();break;case 2:s.value=e.bytes();break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){""!==e.typeUrl&&t.tag(1,T.LengthDelimited).string(e.typeUrl),e.value.length&&t.tag(2,T.LengthDelimited).bytes(e.value);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};var De,Ce;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.GENERIC=1]="GENERIC",e[e.ASSOC=2]="ASSOC"}(De||(De={})),function(e){e[e.UNKNOWN_EXTENSION=0]="UNKNOWN_EXTENSION",e[e.CANVAZ=1]="CANVAZ",e[e.STORYLINES=2]="STORYLINES",e[e.PODCAST_TOPICS=3]="PODCAST_TOPICS",e[e.PODCAST_SEGMENTS=4]="PODCAST_SEGMENTS",e[e.AUDIO_FILES=5]="AUDIO_FILES",e[e.TRACK_DESCRIPTOR=6]="TRACK_DESCRIPTOR",e[e.PODCAST_COUNTER=7]="PODCAST_COUNTER",e[e.ARTIST_V4=8]="ARTIST_V4",e[e.ALBUM_V4=9]="ALBUM_V4",e[e.TRACK_V4=10]="TRACK_V4",e[e.SHOW_V4=11]="SHOW_V4",e[e.EPISODE_V4=12]="EPISODE_V4",e[e.PODCAST_HTML_DESCRIPTION=13]="PODCAST_HTML_DESCRIPTION",e[e.PODCAST_QUOTES=14]="PODCAST_QUOTES",e[e.USER_PROFILE=15]="USER_PROFILE",e[e.CANVAS_V1=16]="CANVAS_V1",e[e.SHOW_V4_BASE=17]="SHOW_V4_BASE",e[e.SHOW_V4_EPISODES_ASSOC=18]="SHOW_V4_EPISODES_ASSOC",e[e.TRACK_DESCRIPTOR_SIGNATURES=19]="TRACK_DESCRIPTOR_SIGNATURES",e[e.PODCAST_AD_SEGMENTS=20]="PODCAST_AD_SEGMENTS",e[e.EPISODE_TRANSCRIPTS=21]="EPISODE_TRANSCRIPTS",e[e.PODCAST_SUBSCRIPTIONS=22]="PODCAST_SUBSCRIPTIONS",e[e.EXTRACTED_COLOR=23]="EXTRACTED_COLOR",e[e.PODCAST_VIRALITY=24]="PODCAST_VIRALITY",e[e.IMAGE_SPARKLES_HACK=25]="IMAGE_SPARKLES_HACK",e[e.PODCAST_POPULARITY_HACK=26]="PODCAST_POPULARITY_HACK",e[e.AUTOMIX_MODE=27]="AUTOMIX_MODE",e[e.CUEPOINTS=28]="CUEPOINTS",e[e.PODCAST_POLL=29]="PODCAST_POLL",e[e.EPISODE_ACCESS=30]="EPISODE_ACCESS",e[e.SHOW_ACCESS=31]="SHOW_ACCESS",e[e.PODCAST_QNA=32]="PODCAST_QNA",e[e.CLIPS=33]="CLIPS",e[e.SHOW_V5=34]="SHOW_V5",e[e.EPISODE_V5=35]="EPISODE_V5",e[e.PODCAST_CTA_CARDS=36]="PODCAST_CTA_CARDS",e[e.PODCAST_RATING=37]="PODCAST_RATING",e[e.DISPLAY_SEGMENTS=38]="DISPLAY_SEGMENTS",e[e.GREENROOM=39]="GREENROOM",e[e.USER_CREATED=40]="USER_CREATED",e[e.SHOW_DESCRIPTION=41]="SHOW_DESCRIPTION",e[e.SHOW_HTML_DESCRIPTION=42]="SHOW_HTML_DESCRIPTION",e[e.SHOW_PLAYABILITY=43]="SHOW_PLAYABILITY",e[e.EPISODE_DESCRIPTION=44]="EPISODE_DESCRIPTION",e[e.EPISODE_HTML_DESCRIPTION=45]="EPISODE_HTML_DESCRIPTION",e[e.EPISODE_PLAYABILITY=46]="EPISODE_PLAYABILITY",e[e.SHOW_EPISODES_ASSOC=47]="SHOW_EPISODES_ASSOC",e[e.CLIENT_CONFIG=48]="CLIENT_CONFIG",e[e.PLAYLISTABILITY=49]="PLAYLISTABILITY",e[e.AUDIOBOOK_V5=50]="AUDIOBOOK_V5",e[e.CHAPTER_V5=51]="CHAPTER_V5",e[e.AUDIOBOOK_SPECIFICS=52]="AUDIOBOOK_SPECIFICS",e[e.EPISODE_RANKING=53]="EPISODE_RANKING",e[e.HTML_DESCRIPTION=54]="HTML_DESCRIPTION",e[e.CREATOR_CHANNEL=55]="CREATOR_CHANNEL",e[e.AUDIOBOOK_PROVIDERS=56]="AUDIOBOOK_PROVIDERS",e[e.PLAY_TRAIT=57]="PLAY_TRAIT",e[e.CONTENT_WARNING=58]="CONTENT_WARNING",e[e.IMAGE_CUE=59]="IMAGE_CUE",e[e.STREAM_COUNT=60]="STREAM_COUNT",e[e.AUDIO_ATTRIBUTES=61]="AUDIO_ATTRIBUTES",e[e.NAVIGABLE_TRAIT=62]="NAVIGABLE_TRAIT",e[e.NEXT_BEST_EPISODE=63]="NEXT_BEST_EPISODE",e[e.AUDIOBOOK_PRICE=64]="AUDIOBOOK_PRICE",e[e.EXPRESSIVE_PLAYLISTS=65]="EXPRESSIVE_PLAYLISTS",e[e.DYNAMIC_SHOW_EPISODE=66]="DYNAMIC_SHOW_EPISODE",e[e.LIVE=67]="LIVE",e[e.SKIP_PLAYED=68]="SKIP_PLAYED",e[e.AD_BREAK_FREE_PODCASTS=69]="AD_BREAK_FREE_PODCASTS",e[e.ASSOCIATIONS=70]="ASSOCIATIONS",e[e.PLAYLIST_EVALUATION=71]="PLAYLIST_EVALUATION",e[e.CACHE_INVALIDATIONS=72]="CACHE_INVALIDATIONS",e[e.LIVESTREAM_ENTITY=73]="LIVESTREAM_ENTITY",e[e.SINGLE_TAP_REACTIONS=74]="SINGLE_TAP_REACTIONS",e[e.USER_COMMENTS=75]="USER_COMMENTS",e[e.CLIENT_RESTRICTIONS=76]="CLIENT_RESTRICTIONS",e[e.PODCAST_GUEST=77]="PODCAST_GUEST",e[e.PLAYABILITY=78]="PLAYABILITY",e[e.COVER_IMAGE=79]="COVER_IMAGE",e[e.SHARE_TRAIT=80]="SHARE_TRAIT",e[e.INSTANCE_SHARING=81]="INSTANCE_SHARING",e[e.ARTIST_TOUR=82]="ARTIST_TOUR",e[e.AUDIOBOOK_GENRE=83]="AUDIOBOOK_GENRE",e[e.CONCEPT=84]="CONCEPT",e[e.ORIGINAL_VIDEO=85]="ORIGINAL_VIDEO",e[e.SMART_SHUFFLE=86]="SMART_SHUFFLE",e[e.LIVE_EVENTS=87]="LIVE_EVENTS",e[e.AUDIOBOOK_RELATIONS=88]="AUDIOBOOK_RELATIONS",e[e.HOME_POC_BASECARD=89]="HOME_POC_BASECARD",e[e.AUDIOBOOK_SUPPLEMENTS=90]="AUDIOBOOK_SUPPLEMENTS",e[e.PAID_PODCAST_BANNER=91]="PAID_PODCAST_BANNER",e[e.FEWER_ADS=92]="FEWER_ADS",e[e.WATCH_FEED_SHOW_EXPLORER=93]="WATCH_FEED_SHOW_EXPLORER",e[e.TRACK_EXTRA_DESCRIPTORS=94]="TRACK_EXTRA_DESCRIPTORS",e[e.TRACK_EXTRA_AUDIO_ATTRIBUTES=95]="TRACK_EXTRA_AUDIO_ATTRIBUTES",e[e.TRACK_EXTENDED_CREDITS=96]="TRACK_EXTENDED_CREDITS",e[e.SIMPLE_TRAIT=97]="SIMPLE_TRAIT",e[e.AUDIO_ASSOCIATIONS=98]="AUDIO_ASSOCIATIONS",e[e.VIDEO_ASSOCIATIONS=99]="VIDEO_ASSOCIATIONS",e[e.PLAYLIST_TUNER=100]="PLAYLIST_TUNER",e[e.ARTIST_VIDEOS_ENTRYPOINT=101]="ARTIST_VIDEOS_ENTRYPOINT",e[e.PRERELEASE=102]="PRERELEASE",e[e.CONTENT_ALTERNATIVES=103]="CONTENT_ALTERNATIVES",e[e.SNAPSHOT_SHARING=105]="SNAPSHOT_SHARING"}(Ce||(Ce={}));new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.BatchedEntityRequest",[{no:1,name:"header",kind:"message",T:()=>Ue},{no:2,name:"request",kind:"message",repeat:1,T:()=>Le}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.request=[],void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.header=Ue.internalBinaryRead(e,e.uint32(),n,s.header);break;case 2:s.request.push(Le.internalBinaryRead(e,e.uint32(),n));break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){e.header&&Ue.internalBinaryWrite(e.header,t.tag(1,T.LengthDelimited).fork(),n).join();for(let r=0;r<e.request.length;r++)Le.internalBinaryWrite(e.request[r],t.tag(2,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Ue=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.BatchedEntityRequestHeader",[{no:1,name:"country",kind:"scalar",T:9},{no:2,name:"catalogue",kind:"scalar",T:9},{no:3,name:"task_id",kind:"scalar",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.country="",t.catalogue="",t.taskId=new Uint8Array(0),void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.country=e.string();break;case 2:s.catalogue=e.string();break;case 3:s.taskId=e.bytes();break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){""!==e.country&&t.tag(1,T.LengthDelimited).string(e.country),""!==e.catalogue&&t.tag(2,T.LengthDelimited).string(e.catalogue),e.taskId.length&&t.tag(3,T.LengthDelimited).bytes(e.taskId);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Le=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.EntityRequest",[{no:1,name:"uri",kind:"scalar",T:9},{no:2,name:"query",kind:"message",repeat:1,T:()=>Be}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.uri="",t.query=[],void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.uri=e.string();break;case 2:s.query.push(Be.internalBinaryRead(e,e.uint32(),n));break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){""!==e.uri&&t.tag(1,T.LengthDelimited).string(e.uri);for(let r=0;r<e.query.length;r++)Be.internalBinaryWrite(e.query[r],t.tag(2,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Be=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.ExtensionQuery",[{no:1,name:"kind",kind:"enum",T:()=>["com.spotify.extendedmetadata.proto.ExtensionKind",Ce]},{no:2,name:"etag",kind:"scalar",opt:!0,T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.kind=0,void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.kind=e.int32();break;case 2:s.etag=e.string();break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){0!==e.kind&&t.tag(1,T.Varint).int32(e.kind),void 0!==e.etag&&t.tag(2,T.LengthDelimited).string(e.etag);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const ve=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.BatchedExtensionResponse",[{no:1,name:"header",kind:"message",T:()=>Pe},{no:2,name:"extended_metadata",kind:"message",repeat:1,T:()=>Ve}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.extendedMetadata=[],void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.header=Pe.internalBinaryRead(e,e.uint32(),n,s.header);break;case 2:s.extendedMetadata.push(Ve.internalBinaryRead(e,e.uint32(),n));break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){e.header&&Pe.internalBinaryWrite(e.header,t.tag(1,T.LengthDelimited).fork(),n).join();for(let r=0;r<e.extendedMetadata.length;r++)Ve.internalBinaryWrite(e.extendedMetadata[r],t.tag(2,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Pe=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.BatchedExtensionResponseHeader",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){return r??this.create()}internalBinaryWrite(e,t,n){let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Ve=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.EntityExtensionDataArray",[{no:1,name:"header",kind:"message",T:()=>xe},{no:2,name:"kind",kind:"enum",T:()=>["com.spotify.extendedmetadata.proto.ExtensionKind",Ce]},{no:3,name:"extension_data",kind:"message",repeat:1,T:()=>Fe}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.kind=0,t.extensionData=[],void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.header=xe.internalBinaryRead(e,e.uint32(),n,s.header);break;case 2:s.kind=e.int32();break;case 3:s.extensionData.push(Fe.internalBinaryRead(e,e.uint32(),n));break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){e.header&&xe.internalBinaryWrite(e.header,t.tag(1,T.LengthDelimited).fork(),n).join(),0!==e.kind&&t.tag(2,T.Varint).int32(e.kind);for(let r=0;r<e.extensionData.length;r++)Fe.internalBinaryWrite(e.extensionData[r],t.tag(3,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const xe=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.EntityExtensionDataArrayHeader",[{no:1,name:"provider_error_status",kind:"scalar",T:5},{no:2,name:"cache_ttl_in_seconds",kind:"scalar",T:3,L:2},{no:3,name:"offline_ttl_in_seconds",kind:"scalar",T:3,L:2},{no:4,name:"extension_type",kind:"enum",T:()=>["com.spotify.extendedmetadata.proto.ExtensionType",De]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.providerErrorStatus=0,t.cacheTtlInSeconds=0,t.offlineTtlInSeconds=0,t.extensionType=0,void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.providerErrorStatus=e.int32();break;case 2:s.cacheTtlInSeconds=e.int64().toNumber();break;case 3:s.offlineTtlInSeconds=e.int64().toNumber();break;case 4:s.extensionType=e.int32();break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){0!==e.providerErrorStatus&&t.tag(1,T.Varint).int32(e.providerErrorStatus),0!==e.cacheTtlInSeconds&&t.tag(2,T.Varint).int64(e.cacheTtlInSeconds),0!==e.offlineTtlInSeconds&&t.tag(3,T.Varint).int64(e.offlineTtlInSeconds),0!==e.extensionType&&t.tag(4,T.Varint).int32(e.extensionType);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Fe=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.EntityExtensionData",[{no:1,name:"header",kind:"message",T:()=>$e},{no:2,name:"entity_uri",kind:"scalar",T:9},{no:3,name:"extension_data",kind:"message",T:()=>_e}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.entityUri="",void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.header=$e.internalBinaryRead(e,e.uint32(),n,s.header);break;case 2:s.entityUri=e.string();break;case 3:s.extensionData=_e.internalBinaryRead(e,e.uint32(),n,s.extensionData);break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){e.header&&$e.internalBinaryWrite(e.header,t.tag(1,T.LengthDelimited).fork(),n).join(),""!==e.entityUri&&t.tag(2,T.LengthDelimited).string(e.entityUri),e.extensionData&&_e.internalBinaryWrite(e.extensionData,t.tag(3,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const $e=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.EntityExtensionDataHeader",[{no:1,name:"status_code",kind:"scalar",T:5},{no:2,name:"etag",kind:"scalar",T:9},{no:3,name:"locale",kind:"scalar",T:9},{no:4,name:"cache_ttl_in_seconds",kind:"scalar",T:3,L:2},{no:5,name:"offline_ttl_in_seconds",kind:"scalar",T:3,L:2}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.statusCode=0,t.etag="",t.locale="",t.cacheTtlInSeconds=0,t.offlineTtlInSeconds=0,void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.statusCode=e.int32();break;case 2:s.etag=e.string();break;case 3:s.locale=e.string();break;case 4:s.cacheTtlInSeconds=e.int64().toNumber();break;case 5:s.offlineTtlInSeconds=e.int64().toNumber();break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){0!==e.statusCode&&t.tag(1,T.Varint).int32(e.statusCode),""!==e.etag&&t.tag(2,T.LengthDelimited).string(e.etag),""!==e.locale&&t.tag(3,T.LengthDelimited).string(e.locale),0!==e.cacheTtlInSeconds&&t.tag(4,T.Varint).int64(e.cacheTtlInSeconds),0!==e.offlineTtlInSeconds&&t.tag(5,T.Varint).int64(e.offlineTtlInSeconds);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const je=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.PlainListAssoc",[{no:1,name:"entity_uri",kind:"scalar",repeat:2,T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.entityUri=[],void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();if(1===t)s.entityUri.push(e.string());else{let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){for(let n=0;n<e.entityUri.length;n++)t.tag(1,T.LengthDelimited).string(e.entityUri[n]);let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};const Me=new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.AssocHeader",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){return r??this.create()}internalBinaryWrite(e,t,n){let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}};new class extends ue{constructor(){super("com.spotify.extendedmetadata.proto.Assoc",[{no:1,name:"header",kind:"message",T:()=>Me},{no:2,name:"plain_list",kind:"message",T:()=>je}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return void 0!==e&&se(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),a=e.pos+t;for(;e.pos<a;){let[t,r]=e.tag();switch(t){case 1:s.header=Me.internalBinaryRead(e,e.uint32(),n,s.header);break;case 2:s.plainList=je.internalBinaryRead(e,e.uint32(),n,s.plainList);break;default:let a=n.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let i=e.skip(r);!1!==a&&(!0===a?g.onRead:a)(this.typeName,s,t,r,i)}}return s}internalBinaryWrite(e,t,n){e.header&&Me.internalBinaryWrite(e.header,t.tag(1,T.LengthDelimited).fork(),n).join(),e.plainList&&je.internalBinaryWrite(e.plainList,t.tag(2,T.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return!1!==r&&(1==r?g.onWrite:r)(this.typeName,e,t),t}},r("v1.8.1(1004)");const We=new URL($request.url);r(`⚠ url: ${We.toJSON()}`,"");const Ke=$request.method,Ge=We.hostname,He=We.pathname;r(`⚠ METHOD: ${Ke}, HOST: ${Ge}, PATH: ${He}`,"");const Xe=($response.headers?.["Content-Type"]??$response.headers?.["content-type"])?.split(";")?.[0];r(`⚠ FORMAT: ${Xe}`,""),(async()=>{const{Settings:t,Caches:s,Configs:a}=u("DualSubs","Spotify",c);switch(r(`⚠ Settings.Switch: ${t?.Switch}`,""),t.Switch){case!0:default:const a=We.searchParams.get("subtype")??t.Type,i=[We.searchParams.get("lang")?.toUpperCase?.()??t.Languages[0],(We.searchParams.get("tlang")??s?.tlang)?.toUpperCase?.()??t.Languages[1]];r(`⚠ Type: ${a}, Languages: ${i}`,"");let o={};switch(Xe){case void 0:case"application/x-www-form-urlencoded":case"text/plain":default:case"application/x-mpegURL":case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"audio/mpegurl":case"text/xml":case"text/html":case"text/plist":case"application/xml":case"application/plist":case"application/x-plist":case"text/vtt":case"application/vtt":break;case"text/json":case"application/json":switch(o=JSON.parse($response.body??"{}"),r(`🚧 body: ${JSON.stringify(o)}`,""),He){case"/melody/v1/product_state":o.country=t.Country,o["selected-language"]=t.Languages[1].toLowerCase();break;case"/v1/tracks":o?.tracks?.forEach?.((e=>{r(`🚧 track: ${JSON.stringify(e)}`,"");const t=e?.id,n={track:e?.name,album:e?.album?.name,artist:e?.artists?.[0]?.name};s.Metadatas.Tracks.set(t,n)})),s.Metadatas.Tracks=function(e,t=100){return console.log(`☑️ Set Cache, cacheSize: ${t}`,""),e=(e=Array.from(e||[])).slice(-t),console.log("✅ Set Cache",""),e}(s.Metadatas.Tracks,t.CacheSize),n.setItem("@DualSubs.Spotify.Caches.Metadatas.Tracks",s.Metadatas.Tracks)}$response.body=JSON.stringify(o);break;case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":case"application/grpc":case"application/grpc+proto":case"application/octet-stream":let a="Quantumult X"===e?new Uint8Array($response.bodyBytes??[]):$response.body??new Uint8Array;switch(Xe){case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":switch(He){case"/bootstrap/v1/bootstrap":case"/user-customization-service/v1/customize":switch(He){case"/bootstrap/v1/bootstrap":{o=he.fromBinary(a);let e=o?.ucsResponseV0?.success?.customization?.success?.accountAttributesSuccess?.accountAttributes;e&&(e.country_code={stringValue:t.Country},e=h(e)),a=he.toBinary(o);break}case"/user-customization-service/v1/customize":{o=pe.fromBinary(a);let e=o?.success?.accountAttributesSuccess?.accountAttributes;e&&(e.country_code={stringValue:t.Country},e=h(e)),a=pe.toBinary(o);break}}break;case"/extended-metadata/v0/extended-metadata":o=ve.fromBinary(a),a=ve.toBinary(o)}}$response.body=a}case!1:}})().catch((t=>function(t){switch(e){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Quantumult X":default:r("","❗️执行错误!",t,"");break;case"Node.js":r("","❗️执行错误!",t.stack,"")}}(t))).finally((()=>function(n={}){switch(e){case"Surge":n.policy&&t.set(n,"headers.X-Surge-Policy",n.policy),r("",`🚩 执行结束! 🕛 ${(new Date).getTime()/1e3-$script.startTime} 秒`,""),$done(n);break;case"Loon":n.policy&&(n.node=n.policy),r("",`🚩 执行结束! 🕛 ${(new Date-$script.startTime)/1e3} 秒`,""),$done(n);break;case"Stash":n.policy&&t.set(n,"headers.X-Stash-Selected-Proxy",encodeURI(n.policy)),r("",`🚩 执行结束! 🕛 ${(new Date-$script.startTime)/1e3} 秒`,""),$done(n);break;case"Egern":case"Shadowrocket":default:r("","🚩 执行结束!",""),$done(n);break;case"Quantumult X":n.policy&&t.set(n,"opts.policy",n.policy),delete n["auto-redirect"],delete n["auto-cookie"],delete n["binary-mode"],delete n.charset,delete n.host,delete n.insecure,delete n.method,delete n.opt,delete n.path,delete n.policy,delete n["policy-descriptor"],delete n.scheme,delete n.sessionIndex,delete n.statusCode,delete n.timeout,n.body instanceof ArrayBuffer?(n.bodyBytes=n.body,delete n.body):ArrayBuffer.isView(n.body)?(n.bodyBytes=n.body.buffer.slice(n.body.byteOffset,n.body.byteLength+n.body.byteOffset),delete n.body):n.body&&delete n.bodyBytes,r("","🚩 执行结束!",""),$done(n);break;case"Node.js":r("","🚩 执行结束!",""),process.exit(1)}}($response)));
